<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
        var meetupCount = 20;
        var showMeetupSource = true;
    </script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css"/>    
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/pagedown/1.0/Markdown.Converter.js"></script>

</head>
<body>
<div id="intro"/>
<div id="features"/>

<script>
$(document).ready(function () {

    var baseUrl = "https://dotnetweb.blob.core.windows.net/dotnetcatalog/";
    var catalogJson = "catalog.json";
    var requestUrl = baseUrl + catalogJson;
    var converter = new Markdown.Converter();

    $.support.cors = true;
    $.getJSON(requestUrl, function (data) {
        document.title = data.name;

        $.ajax(baseUrl + data.content).done(function(data) 
        {
            $("#intro").prepend(converter.makeHtml(data));
        });

        $.each(data.categories, function (key, category) {
            var categoryName = category.name;
            while(categoryName.indexOf(".") != -1)
            {
                categoryName = categoryName.replace(".","");
            }

            var target = "cat" + categoryName;
            $("#features").append("<h2>" + category.name + " Features</h2><div class=feature id=" + target+"></div>");
            $.each(category.items, function(key2,item) {
                $.ajax(baseUrl + category.name + "/" + item.content).done(function(data) 
                {
                    var md = converter.makeHtml(data);
                    $("#" + target).append(md);
                });
            });
        });
    });
});
</script>
<style>
.feature h1 {font-size: 18px;}
</style>
</body>
</html>